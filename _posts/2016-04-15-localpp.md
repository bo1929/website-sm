---
layout: post
title: Fast coalescent-based support values
---

Our new paper on coalescent-based branch support estimation just [came out](http://mbe.oxfordjournals.org/cgi/content/abstract/msw079?ijkey=OTHYAZPfjJsY2Ce&keytype=ref) at MBE. 

We introduces a fast and simple method for computing support for branches in an unrooted species tree according to the multi-species coalescent model. The main insight behind the method is simple. For any quartet of species, we can compute the frequencies of its three possible topologies in gene trees, and we can translate these frequencies to probabilities that each of the alternatives is correct. The topology with the highest frequency is the most likely topology, but how much more likely it is compared to the two alternative topologies depends on 1) the number of genes, and 2) the difference between its quartet frequency and the alternatives. This relationship can be analytically derived easily by using properties of a multinomial distribution. The figure below shows an example of the relationship between a branch's quartet support and its probability of correctness. 


<img src="{{ site.url }}/assets/qs-vs-pp-2.png" width="300" alt="image" />

Starting with this principle, we show how all quartet frequencies can be *quickly* computed for each branch in a given species tree (the running time is quadratic in the number of species and linear in the number of genes). We further employ some simplifying assumptions, which enable us to compute a branch support by summarizing the frequencies of all quartets around the branch. Perhaps our most important assumption is the "locality" assumption: for any branch, we assume all the four clusters around it are correct. 

We test the new support calculation method on datasets that violate our assumptions and have high levels of gene tree estimation error. In simulation studies, we show that local posterior probabilities give a more reliable measure of support than the standard multi-locus bootstrapping. 

What's nice is that our new approach fits very well within [ASTRAL](https://github.com/smirarab/ASTRAL). New versions of ASTRAL use local posterior probabilities to quickly compute branch support for the species tree topology that it computes. ASTRAL can compute branch support for a dataset with 1000 genes and 1000 species in a matter of minutes on a normal laptop.

Oh, almost forgot. We also use quartet frequencies for computing branch lengths in coalescent units for internal branches of the species tree (e.g., ASTRAL's output). This feature is also added to ASTRAL. 
